<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course Schedule II</title>
</head>

<body>
    <script>
        function findOrder(numCourses, prerequisites) {
            const preMap = new Map();

            // Set to keep track of courses in the current DFS path (for cycle detection)
            let visiting = new Set();
            let visited = new Set();
            let res = [];

            for (let i = 0; i < numCourses; i++) {
                preMap.set(i, []);
            }

            for (const [crs, pre] of prerequisites) {
                preMap.get(crs).push(pre);
            }

            // In Course Schedule II, dfs apply on each node and check one by one.
            const dfs = (crs) => {
                // This keep track of courses in the current DFS path (for cycle detection).
                // If the course is already in the current DFS path, we found a cycle
                if (visiting.has(crs)) {
                    return false;
                }

                // This keeps track of courses that are fully processed.
                // Meaning: “I already know this course and all its prerequisites can be completed without cycles.”
                // If a course is in visited, we don’t need to DFS it again — this saves time.
                if (visited.has(crs)) {
                    return true;
                }

                visiting.add(crs);

                for (const nei of preMap.get(crs)) {
                    if (!dfs(nei)) {
                        return false;
                    }
                }

                visiting.delete(crs);
                visited.add(crs);
                res.push(crs);
                return true;
            }


            for (let i = 0; i < numCourses; i++) {
                if (!dfs(i)) {
                    return [];
                }
            }

            return res.reverse();
        }









        function findOrder(numCourses, prerequisites) {
            const graph = new Map();
            const state = new Array(numCourses).fill(0);
            const order = [];

            for (let i = 0; i < numCourses; i++) {
                graph.set(i, []);
            }

            for (let [course, prereq] of prerequisites) {
                graph.get(prereq).push(course);
            }

            function dfs(course) {
                if (state[course] === 1) return false; // cycle
                if (state[course] === 2) return true;  // already visited

                state[course] = 1;
                for (let neighbor of graph.get(course)) {
                    if (!dfs(neighbor)) return false;
                }

                state[course] = 2;
                order.push(course); // add after visiting neighbors
                return true;
            }

            for (let i = 0; i < numCourses; i++) {
                if (!dfs(i)) return [];
            }

            return order.reverse(); // reverse postorder
        }

        numCourses = 3, prerequisites = [[1, 0]];
        console.log(findOrder(numCourses, prerequisites));
    </script>
</body>

</html>