<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Design Add and Search Word Data Structure</title>
</head>

<body>
    <script>
        class TrieNode {
            constructor() {
                this.children = new Map();
                this.word = false;
            }
        }


        class WordDictionary {
            constructor() {
                this.root = new TrieNode();
            }

            addWord(word) {
                let cur = this.root;
                for (const c of word) {
                    if (!cur.children.has(c)) {
                        cur.children.set(c, new TrieNode());
                    }
                    cur = cur.children.get(c);
                }
                cur.word = true;
            }


            search(word) {
                const dfs = (i, node) => {
                    if (i === word.length) {
                        return node.word;
                    }

                    const c = word[i];

                    if (c === '.') {
                        for (const child of node.children.values()) {
                            if (dfs(i + 1, child)) {
                                return true;
                            }
                        }
                        return false;
                    } else {
                        if (!node.children.has(c)) {
                            return false;
                        }
                        node = node.children.get(c);
                        return dfs(i + 1, node);
                    }
                }

                return dfs(0, this.root);
            }
        }


        const dict = new WordDictionary();
        dict.addWord("bat");
        dict.addWord("bad");
        dict.addWord("pad");

        console.log(dict.search("bat"));   // true
        console.log(dict.search("b.t"));   // true ('.' matches 'a')
        console.log(dict.search("ba."));   // true
        console.log(dict.search("..."));   // true
        console.log(dict.search("b.."));   // true
        console.log(dict.search("pa."));   // true
        console.log(dict.search("cat"));   // false
    </script>
</body>

</html>