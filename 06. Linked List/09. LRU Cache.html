<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LRU Cache</title>
</head>

<body>
    <script>
        class Node {
            constructor(key, val) {
                this.key = key;
                this.val = val;
                this.prev = null;
                this.next = null;
            }
        }

        class LRUCache {
            constructor(capacity) {
                this.cap = capacity;
                this.cache = new Map();

                // Create two dummy nodes:
                // head = MOST Recently Used
                // tail = LEAST Recently Used
                this.head = new Node(0, 0);
                this.tail = new Node(0, 0);

                // Link head and tail together
                this.head.next = this.tail;
                this.tail.prev = this.head;
            }

            // remove from list (anywhere)
            remove(node) {
                // node connect its previous node to its next node.
                node.prev.next = node.next;

                // node connect its next node to its previous node.
                node.next.prev = node.prev;
            }


            // insert node after head
            insert(node) {
                node.next = this.head.next;
                node.prev = this.head;
                this.head.next.prev = node;
                this.head.next = node;
            }


            get(key) {
                if (!this.cache.has(key)) return -1;
                const node = this.cache.get(key);
                this.remove(node);
                this.insert(node);
                return node.val;
            }

            put(key, value) {
                if (this.cache.has(key)) {
                    const node = this.cache.get(key);
                    node.val = value;       // Update value
                    this.remove(node);
                    this.insert(node);      // Move to MRU
                    return;
                }

                const node = new Node(key, value);
                this.cache.set(key, node);
                this.insert(node);

                if (this.cache.size > this.cap) {
                    const lru = this.tail.prev;
                    this.remove(lru);
                    this.cache.delete(lru.key);
                }
            }
        }
    </script>
</body>

</html>
